I"ı:<p>åŸæ–‡ï¼š<a href="http://expressjs.com/en/guide/migrating-4.html">http://expressjs.com/en/guide/migrating-4.html</a></p>

<p>Express 4.xè¾ƒExpress 3.xè¿›è¡Œäº†è¾ƒå¤§çš„æ”¹åŠ¨ï¼ŒåŸæ¥åŸºäºExpress 3.xçš„é¡¹ç›®æ— æ³•ç›´æ¥å‡çº§åˆ° 4.xã€‚æœ¬æ–‡å¯¹Expressç½‘ç«™çš„å†…å®¹è¿›è¡Œäº†ç®€å•çš„æ€»ç»“ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©å¤§å®¶æ›´å¥½çš„äº†è§£Express 4.xï¼ŒåŒæ—¶æ–¹ä¾¿å¤§å®¶è¿ç§»ã€‚</p>
<h2 id="ä¸€express-4xçš„ä¸»è¦å˜åŒ–">ä¸€ã€Express 4.xçš„ä¸»è¦å˜åŒ–</h2>
<p>1ã€é‡æ–°æ’°å†™Expresså†…æ ¸ï¼Œå–æ¶ˆäº†åŸæ¥å¯¹äºConnectçš„ä¾èµ–<br />
2ã€ç§»é™¤äº†å¤§éƒ¨åˆ†Build-inçš„Middleware<br />
3ã€Middlewareå¯ä»¥ä»…å¯¹ç‰¹å®šurlå‰ç¼€çš„è¯·æ±‚æ‰§è¡Œï¼Œå¹¶ä¸”æ”¯æŒurlä¸­çš„å‚æ•°<br />
4ã€å¯¹Routingç³»ç»Ÿçš„æ‰©å±•</p>
<h3 id="å–æ¶ˆconnectçš„ä¾èµ–">å–æ¶ˆConnectçš„ä¾èµ–</h3>
<p>Express 3.xæ˜¯åŸºäºConnectæ„å»ºçš„ã€‚é‡æ„åçš„Express 4.xå–æ¶ˆäº†å¯¹Connectçš„ä¾èµ–ï¼Œå˜æˆäº†å®Œå…¨ç‹¬ç«‹çš„æ¨¡å—ã€‚ä½†ç”±äºé‡‡ç”¨ä¸€è‡´çš„Middlewareå¤„ç†æ–¹æ³•ï¼Œæ–°çš„Express 4.xä»ç„¶å¯¹Connectçš„æ‰€æœ‰Middlewareå‘ä¸‹å…¼å®¹ï¼Œæ‰€ä»¥åœ¨Expressä¸­ä»ç„¶å¯ä»¥ä½¿ç”¨Connectçš„Middlewareã€‚</p>
<h3 id="ç§»é™¤ç»å¤§å¤šæ•°build-inçš„middleware">ç§»é™¤ç»å¤§å¤šæ•°Build-inçš„Middleware</h3>
<p>Express 4.xçš„ç†å¿µæ˜¯ä»…ä¸“æ³¨äºæœ€æ ¸å¿ƒçš„routingåŠŸèƒ½ï¼Œè€Œå°†å…¶ä»–ç»„å»ºçš„é€‰æ‹©å…¨éƒ¨äº¤ç”±ç”¨æˆ·é…ç½®ï¼Œä¸€æ–¹é¢æä¾›æ›´å¥½çš„çµæ´»å’Œå®šåˆ¶æ€§ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥å§‹ç»ˆè®©ç”¨æˆ·ä½¿ç”¨æœ€æ–°çš„Middlewareè€Œå°†å…¶å’ŒExpressçš„æ›´æ–°ç‹¬ç«‹å¼€æ¥ã€‚å…¶æ ¸å¿ƒä¸­ä»…ä¿ç•™äº†express.staticï¼Œå…¶ä½™Middlewareå‡éœ€è¦é€šè¿‡npmå®‰è£…å¹¶ä¸”requireã€‚ä¸‹è¡¨ä¸­æ˜¯ä¸»è¦ç§»é™¤çš„æ¨¡å—åˆ—è¡¨ï¼š</p>

<table>
  <thead>
    <tr>
      <th>express 3</th>
      <th>express 4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>express.bodyParser</td>
      <td>body-parser+mnlter</td>
    </tr>
    <tr>
      <td>express.comperss</td>
      <td>compression</td>
    </tr>
    <tr>
      <td>express.cookieSession</td>
      <td>cookie-session</td>
    </tr>
    <tr>
      <td>express.cookieParser</td>
      <td>cookie-parser</td>
    </tr>
    <tr>
      <td>express.logger</td>
      <td>morgan</td>
    </tr>
    <tr>
      <td>express.session</td>
      <td>express.session</td>
    </tr>
    <tr>
      <td>express.favicon</td>
      <td>serve-favicon</td>
    </tr>
    <tr>
      <td>express.responseTime</td>
      <td>response-time</td>
    </tr>
    <tr>
      <td>express.errorHandler</td>
      <td>errorhandler</td>
    </tr>
    <tr>
      <td>express.methodOverride</td>
      <td>method-override</td>
    </tr>
    <tr>
      <td>express.timeout</td>
      <td>connect-timeout</td>
    </tr>
    <tr>
      <td>express.vhost</td>
      <td>vhost</td>
    </tr>
    <tr>
      <td>express.csrf</td>
      <td>csurf</td>
    </tr>
    <tr>
      <td>express.directory</td>
      <td>serve-index</td>
    </tr>
    <tr>
      <td>express.static</td>
      <td>serve-static</td>
    </tr>
  </tbody>
</table>

<p>ä¸‹é¢æ˜¯Express 4çš„ä¸­é—´ä»¶çš„å®Œæ•´åˆ—è¡¨ã€‚
åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç®€å•åœ°ç”¨express 4æ›¿æ¢æ—§ç‰ˆæœ¬express 3ä¸­å¯¹åº”çš„ä¸­é—´ä»¶ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…GitHubçš„æ¨¡å—æ–‡æ¡£ã€‚</p>
<h3 id="appuse-accepts-parameters">app.use accepts parameters</h3>
<p>åœ¨ç¬¬4ç‰ˆï¼Œä½ ç°åœ¨å¯ä»¥åœ¨å…·æœ‰å¯å˜å‚æ•°çš„è·¯å¾„ä¸ŠåŠ è½½ä¸­é—´ä»¶ï¼Œå¹¶ä»è·¯ç”±å¤„ç†ç¨‹åºä¸­è¯»å–å‚æ•°å€¼ã€‚ ä¾‹å¦‚ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.use('/book/:id', function(req, res, next) {
  console.log('ID:', req.params.id);
  next();
}); ### The routing system åº”ç”¨éšå¼åŠ è½½è·¯ç”±ä¸­é—´ä»¶ï¼Œæ‰€ä»¥ï¼Œç°åœ¨ä½ ä¸å¿…æ‹…å¿ƒ router è·¯ç”±ä¸­é—´ä»¶åŠ è½½çš„æ¬¡åºé—®é¢˜ã€‚
</code></pre></div></div>

<p>å®šä¹‰è·¯ç”±çš„æ–¹å¼æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œç°åœ¨å¢åŠ äº†ä¸¤ä¸ªæ–°çš„ç‰¹æ€§æ¥å¸®åŠ©ç»„ç»‡è·¯ç”±ç³»ç»Ÿã€‚</p>
<blockquote>
  <ul>
    <li>æ–°çš„æ–¹æ³• routeï¼Œé’ˆå¯¹ä¸€ä¸ªè·¯ç”±è·¯å¾„åˆ›å»ºé“¾å¼çš„è·¯ç”±å¤„ç†å™¨ã€‚</li>
    <li>æ–°çš„ç±» express.Routerï¼Œåˆ›å»ºæ¨¡å—åŒ–çš„è·¯ç”±å¤„ç†å™¨ã€‚</li>
  </ul>
</blockquote>

<h3 id="approute-method">app.route() method</h3>
<p>æ–°çš„ app.route æ–¹æ³•å¯¹ç‰¹å®šçš„è·¯ç”±è·¯å¾„åˆ›å»ºé“¾å¼çš„è·¯ç”±å¤„ç†å™¨ã€‚ç”±äºå¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰è·¯å¾„ï¼Œè¿™æ ·æœ‰åŠ©äºåˆ›å»ºæ¨¡å—è¯çš„è·¯ç”±è§„åˆ™ï¼Œå‡å°‘é‡å¤ã€‚</p>

<p>è·¯ç”±çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥å‚è§ Route() çš„æ–‡æ¡£ã€‚<br />
ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†è·¯ç”±çš„é“¾å¼å®šä¹‰</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.route('/book')
  .get(function(req, res) {
    res.send('Get a random book');
  })
  .post(function(req, res) {
    res.send('Add a book');
  })
  .put(function(req, res) {
    res.send('Update the book');
  }) ### express.Router class å¦å¤–ä¸€ä¸ªå¸®åŠ©ç»„ç»‡è·¯ç”±çš„ç‰¹æ€§æ˜¯æ–°çš„ç±» express.Routerï¼Œå¯ä»¥å¸®åŠ©åˆ›å»ºæ¨¡å—è¯çš„è·¯ç”±å¤„ç†å™¨ã€‚ä¸€ä¸ª Router çš„å®ä¾‹å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸­é—´ä»¶å’Œè·¯ç”±ç³»ç»Ÿï¼Œç”±äºè¿™ä¸ªåŸå› ï¼Œå®ƒç»å¸¸è¢«ç§°ä¸º è¿·ä½ åº”ç”¨ã€‚
</code></pre></div></div>

<p>ä¸‹é¢æ¼”ç¤ºäº†åˆ›å»ºä¸€ä¸ªåä¸º bird.js çš„è·¯ç”±æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var express = require('express');
var router = express.Router();

// middleware specific to this router
router.use(function timeLog(req, res, next) {
  console.log('Time: ', Date.now());
  next();
})
// define the home page route
router.get('/', function(req, res) {
  res.send('Birds home page');
})
// define the about route
router.get('/about', function(req, res) {
  res.send('About birds');
})

module.exports = router; ç„¶ååœ¨åº”ç”¨ä¸­åŠ è½½è¿™ä¸ªè·¯ç”±æ¨¡å—ã€‚

var birds = require('./birds');
...
app.use('/birds', birds); è¿™ä¸ªåº”ç”¨ç°åœ¨å¯ä»¥å¤„ç†è¯·æ±‚ /birds å’Œ /birds/aboutï¼Œè¿˜å¯ä»¥è°ƒç”¨ timeLog ä¸­é—´ä»¶ã€‚   ### Other changes ä¸‹è¡¨åˆ—å‡ºäº†å…¶å®ƒå°çš„ä½†æ˜¯é‡è¦çš„ä¿®æ”¹  
</code></pre></div></div>
<table class="table-striped table-condensed">
	<tr>
		<td>å¯¹è±¡</td>
		<td>è¯´æ˜</td>
	</tr>
	<tr>
		<td>Node</td>
		<td>Express 4 éœ€è¦ Node 0.10.x åŠå…¶ä»¥ä¸Šç‰ˆæœ¬ï¼Œå·²ç»ä¸æ”¯æŒ 0.8.x</td>
	</tr>
	<tr>
		<td>http.createServer</td>
		<td>ä¸å†éœ€è¦ http æ¨¡å—ï¼Œåº”ç”¨ä½¿ç”¨ app.listen() å¯åŠ¨</td>
	</tr>
	<tr>
		<td>app.configure()</td>
		<td>app.configure() å·²ç»è¢«ç§»é™¤ï¼Œä½¿ç”¨ process.env.NODE_ENV æˆ–è€… app.get(â€œenvâ€) æ¥æ£€æµ‹ç¯å¢ƒã€é…ç½®åº”ç”¨</td>
	</tr>
	<tr>
		<td>json.spaces()</td>
		<td>åœ¨ Express 4 ä¸­é»˜è®¤ç¦ç”¨äº† json spaces</td>
	</tr>
	<tr>
		<td>Req.location()</td>
		<td>ä¸å†èƒ½è·å–ç›¸å¯¹ url</td>
	</tr>
	<tr>
		<td>Req.params</td>
		<td>åŸæ¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç°åœ¨æ˜¯å¯¹è±¡</td>
	</tr>
	<tr>
		<td>Res.locals</td>
		<td>åŸæ¥æ˜¯å‡½æ•°ï¼Œç°åœ¨æ˜¯å¯¹è±¡</td>
	</tr>
	<tr>
		<td>Res.headerSent</td>
		<td>ä¿®æ”¹ä¸º res.headersSent</td>
	</tr>
	<tr>
		<td>App.route</td>
		<td>ç°åœ¨ä½œä¸º app.mountpath å­˜åœ¨</td>
	</tr>
	<tr>
		<td>Res.on(â€œheaderâ€)</td>
		<td>åˆ é™¤</td>
	</tr>
	<tr>
		<td>Res.charset</td>
		<td>åˆ é™¤</td>
	</tr>
	<tr>
		<td>Res.setHeader(â€œSet-Cookieâ€, val)</td>
		<td>è¿™ä¸ªåŠŸèƒ½ç°åœ¨é™åˆ¶ä¸ºè®¾ç½®åŸºæœ¬çš„ cookie å€¼ï¼Œä½¿ç”¨ res.cookie() çš„æ·»åŠ åŠŸèƒ½</td>
	</tr>  
</table>

<h2 id="äºŒ-ç¤ºä¾‹">äºŒ ã€ç¤ºä¾‹</h2>
<p>è¿™é‡Œæ˜¯ä¸€ä¸ªä» Express 3 å‡çº§åˆ° Express 4 çš„ç¤ºä¾‹ã€‚</p>
<h3 id="version-3-app">Version 3 app</h3>
<h4 id="appjs">app.js</h4>
<p>åŸæ¥çš„ app.js å¦‚ä¸‹ï¼š<br />
	var express = require(â€˜expressâ€™);
	var routes = require(â€˜./routesâ€™);
	var user = require(â€˜./routes/userâ€™);
	var http = require(â€˜httpâ€™);
	var path = require(â€˜pathâ€™);</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'jade');
app.use(express.favicon());
app.use(express.logger('dev'));
app.use(express.methodOverride());
app.use(express.session({ secret: 'your secret here' }));
app.use(express.bodyParser());
app.use(app.router);
app.use(express.static(path.join(__dirname, 'public')));

// development only
if ('development' == app.get('env')) {
  app.use(express.errorHandler());
}

app.get('/', routes.index);
app.get('/users', user.list);

http.createServer(app).listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
}); package.json å¦‚ä¸‹æ‰€ç¤º   é™„å¸¦çš„ç¬¬3ç‰ˆçš„package.jsonæ–‡ä»¶å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

{
  "name": "application-name",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "express": "3.12.0",
    "jade": "*"
  }
}
</code></pre></div></div>

<h3 id="è¿ç§»è¿‡ç¨‹">è¿ç§»è¿‡ç¨‹</h3>
<p>åœ¨è¿ç§»ä¹‹å‰ï¼Œå…ˆå®‰è£… Express 4 éœ€è¦çš„ä¸­é—´ä»¶ï¼Œè¿˜è¦æ›´æ–° expressï¼ŒJade åˆ°æœ€æ–°çš„ç‰ˆæœ¬ã€‚</p>
<blockquote>
  <p>$ npm install serve-favicon morgan method-override express-session body-parser multer errorhandler express@latest jade@latest â€“save</p>
</blockquote>

<p>å¯¹ app.js è¿›è¡Œä¸€ä¸‹çš„ä¿®æ”¹ã€‚</p>

<ol>
  <li>
    <p>http æ¨¡å—å·²ç»ä½¿ç”¨äº†ï¼Œæ‰€ä»¥ï¼Œåˆ é™¤ var http = require( â€œhttpâ€ );</p>
  </li>
  <li>
    <p>å†…å»ºçš„ä¸­é—´ä»¶ express.favicon, express.logger, express.methodOverride, express.session, express.bodyParser å’Œ express.errorHandler å·²ç»ä¸å­˜åœ¨äº†ï¼Œä½ å¿…é¡»æ‰‹åŠ¨å®‰è£…ï¼Œç„¶ååœ¨åº”ç”¨ä¸­æ›¿æ¢å®ƒä»¬ã€‚</p>
  </li>
  <li>
    <p>ä¸å†éœ€è¦åŠ è½½ app.router ï¼Œå®é™…ä¸Šï¼Œå®ƒä¹Ÿå·²ç»ä¸æ˜¯ Express 4 ä¸­çš„å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œåˆ é™¤ app.use( app.router );</p>
  </li>
  <li>
    <p>ä½¿ç”¨ app.listen() æ¥å–ä»£ http.createServer å¯åŠ¨ã€‚</p>
  </li>
</ol>

<h3 id="version-4-app">Version 4 app</h3>
<h4 id="packagejson">package.json</h4>
<p>æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œä¼šå¦‚ä¸‹æ›´æ–° package.json æ–‡ä»¶ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "name": "application-name",
  "version": "0.0.1",
  "private": true,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "body-parser": "^1.5.2",
    "errorhandler": "^1.1.1",
    "express": "^4.8.0",
    "express-session": "^1.7.2",
    "jade": "^1.5.0",
    "method-override": "^2.1.2",
    "morgan": "^1.2.2",
    "multer": "^0.1.3",
    "serve-favicon": "^2.0.1"
  }
} #### app.js ç„¶åï¼Œåˆ é™¤æ— æ•ˆçš„ä»£ç ï¼ŒåŠ è½½éœ€è¦çš„ä¸­é—´ä»¶ï¼Œå®Œæˆå…¶å®ƒå¿…é¡»çš„ä¿®æ”¹ï¼Œæœ€ç»ˆçš„ app.js çœ‹èµ·æ¥å¦‚ä¸‹æ‰€ç¤ºï¼š

var express = require('express');
var routes = require('./routes');
var user = require('./routes/user');
var path = require('path');

var favicon = require('serve-favicon');
var logger = require('morgan');
var methodOverride = require('method-override');
var session = require('express-session');
var bodyParser = require('body-parser');
var multer = require('multer');
var errorHandler = require('errorhandler');

var app = express();

// all environments
app.set('port', process.env.PORT || 3000);
app.set('views', path.join(__dirname, 'views'));
app.set('view engine', 'jade');
app.use(favicon(__dirname + '/public/favicon.ico'));
app.use(logger('dev'));
app.use(methodOverride());
app.use(session({ resave: true,
                  saveUninitialized: true,
                  secret: 'uwotm8' }));
app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));
app.use(multer());
app.use(express.static(path.join(__dirname, 'public')));

// development only
if ('development' == app.get('env')) {
  app.use(errorHandler());
}

app.get('/', routes.index);
app.get('/users', user.list);

app.listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
}); é™¤éä½ éœ€è¦ç›´æ¥ä¸HTTPæ¨¡å—ï¼ˆsocket.io/SPDY/HTTPSï¼‰å·¥ä½œï¼ŒåŠ è½½å®ƒä¸æ˜¯å¿…éœ€çš„ï¼Œå¹¶ä¸”appå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼ç®€å•çš„å¯åŠ¨ï¼š

app.listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
}); ### è¿è¡Œapp ç°åœ¨ï¼Œè¿ç§»å·²ç»å®Œæˆäº†ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ã€‚

$ node app
</code></pre></div></div>

<p>ä½¿ç”¨æµè§ˆå™¨è®¿é—® http://localhost:3000ï¼ŒæŸ¥çœ‹ä½¿ç”¨ Express 4 ç”Ÿæˆçš„é¡µé¢ã€‚</p>
<h2 id="å‡çº§åˆ°-express-4-çš„åº”ç”¨ç”Ÿæˆå™¨">å‡çº§åˆ° Express 4 çš„åº”ç”¨ç”Ÿæˆå™¨</h2>
<p>ç”Ÿæˆä¸€ä¸ª Express 4 çš„å‘½ä»¤è¡Œå·¥å…·è¿˜æ˜¯ expressï¼Œä½†æ˜¯ï¼Œå‡çº§åˆ°æ–°ç‰ˆæœ¬çš„è¯ï¼Œéœ€è¦å…ˆå¸è½½ Express 3 çš„ç”Ÿæˆå™¨ï¼Œç„¶åå®‰è£…æ–°çš„ç”Ÿæˆå™¨ã€‚</p>
<h3 id="å®‰è£…">å®‰è£…</h3>
<p>å¦‚æœä½ å·²ç»å®‰è£…è¿‡ Express 3 çš„ç”Ÿæˆå™¨ï¼Œå¿…é¡»å…ˆå¸è½½</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm uninstall â€“g express 
</code></pre></div></div>

<p>ä¾èµ–ä¸ä½ çš„ç›®å½•æƒé™å’Œé…ç½®ï¼Œå¯èƒ½éœ€è¦å…ˆæ‰§è¡Œ sudo æå‡æƒé™ã€‚
ç°åœ¨ï¼Œå®‰è£…æ–°çš„ç”Ÿæˆå™¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Npm install â€“g express-generator
</code></pre></div></div>

<p>ç°åœ¨ï¼Œä½ ç³»ç»Ÿä¸­çš„ express å‘½ä»¤å·²ç»å‡çº§ä¸º Express 4 çš„ç”Ÿæˆå™¨äº†.</p>
<h3 id="ç”Ÿæˆå™¨çš„å˜åŒ–">ç”Ÿæˆå™¨çš„å˜åŒ–</h3>
<p>é™¤äº†ä¸‹é¢çš„å˜åŒ–ï¼ŒåŸºæœ¬ä¸Šä¸ä»¥å‰ç›¸åŒã€‚</p>

<p>â€“sessions é€‰é¡¹è¢«åˆ é™¤äº†<br />
â€“jshtml é€‰é¡¹è¢«åˆ é™¤äº†<br />
â€“hogan è¢«æ·»åŠ ï¼Œä»¥ä¾¿æ”¯æŒ Hogan.js</p>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3>
<p>æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œåˆ›å»º app4 åº”ç”¨</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>express app4
</code></pre></div></div>

<p>å¦‚æœä½ æŸ¥çœ‹ app4 æ–‡ä»¶å¤¹ä¸­çš„ app.js æ–‡ä»¶ï¼Œä½ ä¼šå‘ç°æ‰€æœ‰çš„ä¸­é—´ä»¶è¢«æ›¿æ¢ä¸ºç‹¬ç«‹çš„ä¸­é—´ä»¶åŠ è½½ï¼Œrouter ä¸­é—´ä»¶ä¸å†æ˜¾å¼åŠ è½½ã€‚ä½ è¿˜ä¼šæ³¨æ„åˆ° app.js ç°åœ¨æ˜¯ä¸€ä¸ª Node æ¨¡å—ã€‚<br />
å®‰è£…ä¾èµ–çš„æ–‡ä»¶ä¹‹åï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨åº”ç”¨ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ npm start
</code></pre></div></div>

<p>å¦‚æœä½ æŸ¥çœ‹ package.json ä¸­çš„å¯åŠ¨è„šæœ¬ï¼Œä½ ä¼šæ³¨æ„åˆ°å®é™…çš„å¯åŠ¨è„šæœ¬æ˜¯ node ./bin/wwwï¼Œåœ¨ Express 3 ä¸­æ˜¯ node app.js.ç”±äº Express 4 æ–°ç”Ÿæˆçš„ app.js å·²ç»æ˜¯ä¸€ä¸ª Node æ¨¡å—ï¼Œå®ƒå¯ä»¥ä¸å†éœ€è¦é€šè¿‡ä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨æ¥å¯åŠ¨ï¼Œå®ƒå¯ä»¥åœ¨ Node æ–‡ä»¶ä¸­åŠ è½½ï¼Œé€šè¿‡ Node æ–‡ä»¶å¯åŠ¨ï¼Œè¿™é‡Œå°±æ˜¯ ./bin/www.ä¸ç®¡æ˜¯ bin æ–‡ä»¶å¤¹ï¼Œè¿˜æ˜¯ www æ–‡ä»¶ï¼Œä»–ä»¬éƒ½æ˜¯æ‰‹å·¥ç”± Express ç”Ÿæˆå™¨ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ï¼Œéœ€è¦çš„è¯ï¼Œéƒ½å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚ä¸ºäº†ä¸ Express 3 ä¿æŒä¸€è‡´ï¼Œåˆ é™¤ module.experts = appï¼›åœ¨ app.js çš„æœ€åï¼Œæ·»åŠ ä¸‹é¢çš„ä»£ç ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});  ç¡®è®¤åŠ è½½ debug æ¨¡å—ã€‚

var debug = require('debug')('app4'); ç„¶åå°† package.json æ–‡ä»¶ä¸­çš„ start: "node ./bin/www" ä¿®æ”¹ä¸º "start": "node app.js"ã€‚ç°åœ¨ï¼Œå·²ç»ä» ./bin/www å›åˆ°äº† app.jsã€‚
</code></pre></div></div>
:ET