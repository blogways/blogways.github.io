I"ç<p><img src="/images/jyjsjd/bean.png" alt="bean.png" /></p>

<h3 id="ä¸€bean-å®ä¾‹åŒ–ç­–ç•¥beanwrapper">ä¸€ã€Bean å®ä¾‹åŒ–ç­–ç•¥â€”â€”BeanWrapper</h3>
<p>å®¹å™¨é€šè¿‡ç­–ç•¥æ¨¡å¼å†³å®šä»¥ä½•ç§æ–¹å¼å®ä¾‹åŒ– Beanï¼Œé€šå¸¸é€šè¿‡<em>åå°„</em>æˆ–<em>CGLIB</em>ã€‚å®ä¾‹åŒ–ç­–ç•¥æ¨¡å¼çš„æ¥å£æ˜¯ <code class="language-plaintext highlighter-rouge">InstantiationStrategy</code>ã€‚</p>

<ul>
  <li>SimpleInstantiationStrategyï¼šé€šè¿‡åå°„å®ä¾‹åŒ–å¯¹è±¡ï¼Œä½†<strong>ä¸æ”¯æŒ</strong><em>æ–¹æ³•æ³¨å…¥å¼</em>çš„å¯¹è±¡å®ä¾‹åŒ–ã€‚</li>
  <li>CglibSubclassingInstantiationStrategyï¼šä»¥ CGLIB åŠ¨æ€å­—èŠ‚ç æ–¹å¼å®ç°å®ä¾‹åŒ–ï¼Œå¹¶ä¸æ˜¯ç›´æ¥è¿”å›å¯¹è±¡å®ä¾‹ï¼Œè€Œæ˜¯å¯¹è±¡çš„åŒ…è£…ï¼Œè¿”å› <code class="language-plaintext highlighter-rouge">BeanWrapper</code> å®ä¾‹ã€‚</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">BeanWrapper</code> çš„å®ç°ç±» <code class="language-plaintext highlighter-rouge">BeanWrapperImpl</code> åŒæ—¶ç›´æ¥æˆ–é—´æ¥åœ°ç»§æ‰¿äº† <code class="language-plaintext highlighter-rouge">PropertyEditorRegistry</code> å’Œ <code class="language-plaintext highlighter-rouge">TypeConverter</code>ï¼Œå¯ä»¥ç”¨åˆ° <code class="language-plaintext highlighter-rouge">CustomEditorConfigurer</code> è½¬æ¢ç±»å‹ã€‚</p>

<p><img src="/images/jyjsjd/beanwrapper.png" alt="beanwrapper.png" /></p>

<h3 id="äºŒaware-æ¥å£">äºŒã€Aware æ¥å£</h3>
<p>å½“å¯¹è±¡å®ä¾‹åŒ–å®Œæˆå¹¶ä¸”ç›¸å…³å±æ€§å’Œä¾èµ–è®¾ç½®å®Œæˆä¹‹åï¼ŒSpring å®¹å™¨ä¼šæ£€æŸ¥å½“å‰å®ä¾‹å¯¹è±¡æ˜¯å¦å®ç°äº†ä¸€ç³»åˆ— <em>Aware</em> æ¥å£ï¼Œå¹¶æŠŠ Aware æ¥å£å®šä¹‰çš„ä¾èµ–æ³¨å…¥è¿›å»ã€‚</p>

<h4 id="1beanfactory">1ã€BeanFactory</h4>
<ul>
  <li>BeanNameAwareï¼šå°†è¯¥å¯¹è±¡å®ä¾‹çš„ bean å®šä¹‰å¯¹åº”çš„ <em>BeanName</em> è®¾ç½®åˆ°å½“å‰å¯¹è±¡å®ä¾‹ã€‚</li>
  <li>BeanClassLoaderAwareï¼šå°†å¯¹åº”åŠ è½½å½“å‰ bean çš„ <em>ClassLoader</em> æ³¨å…¥åˆ°å½“å‰å®ä¾‹ã€‚</li>
  <li>BeanFactoryAwareï¼šBeanFactory ä¼šå°†è‡ªèº«æ³¨å…¥åˆ°å½“å‰å¯¹è±¡ã€‚</li>
</ul>

<h4 id="2applicationcontext">2ã€ApplicationContext</h4>
<p>ä»¥ä¸‹æ‰€æœ‰éƒ½ä¼šæ³¨å…¥ <em>ApplicationContext</em> å®¹å™¨æœ¬èº«ï¼š</p>
<ul>
  <li>ResourceLoaderAware</li>
  <li>ApplicationEventPublisherware</li>
  <li>MessageSourceAware</li>
  <li>ApplicationContextAware</li>
</ul>

<h3 id="ä¸‰beanpostprocessor">ä¸‰ã€BeanPostProcessor</h3>
<p>BeanPostProcessor å­˜åœ¨äºå¯¹è±¡<em>å®ä¾‹åŒ–</em>é˜¶æ®µã€‚æ¥å£å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«åœ¨ä¸åŒçš„æ—¶æœºæ‰§è¡Œï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BeanPostProcessor</span> <span class="o">{</span>
  <span class="c1">// å‰ç½®å¤„ç†</span>
	<span class="nc">Object</span> <span class="nf">postProcessBeforeInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span><span class="o">;</span>
  <span class="c1">// åç½®å¤„ç†</span>
	<span class="nc">Object</span> <span class="nf">postProcessAfterInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å‰æ–‡æ‰€è¿°çš„ ApplicationContext çš„ <em>Aware æ¥å£</em>å®é™…ä¸Šå°±æ˜¯åˆ©ç”¨äº† BeanPostProcessor çš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚</p>

<p>ApplicationContext ä¸­å¯¹è±¡å®ä¾‹åŒ–è¿‡ç¨‹èµ°åˆ° BeanPostProcessor å‰ç½®å¤„ç†æ—¶ï¼Œå®¹å™¨ä¼šæ£€æµ‹æ³¨å†Œçš„ <code class="language-plaintext highlighter-rouge">ApplicationContextAwareProcessor</code> ï¼ˆå®ç°äº† BeanPostProcessorï¼‰ï¼Œè°ƒç”¨ <code class="language-plaintext highlighter-rouge">postProcessBeforeInitialization</code>ï¼Œæ£€æŸ¥å¹¶è®¾ç½® Aware ç›¸å…³ä¾èµ–ã€‚</p>

<h3 id="å››initializingbeanå’Œinit-method">å››ã€InitializingBeanå’Œinit-method</h3>
<ul>
  <li>
    <p>InitializingBean æ˜¯å®¹å™¨ä½¿ç”¨çš„å¯¹è±¡ç”Ÿå‘½å‘¨æœŸæ ‡è¯†æ¥å£ï¼š</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">InitializingBean</span> <span class="o">{</span> 
  <span class="kt">void</span> <span class="nf">afterPropertiesSet</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span> 
<span class="o">}</span>
</code></pre></div>    </div>

    <p>å®ƒçš„ä½œç”¨åœ¨äºï¼Œåœ¨å¯¹è±¡å®ä¾‹åŒ–è¿‡ç¨‹ä¸­è°ƒç”¨ BeanPostProcessor çš„å‰ç½®å¤„ç†ä¹‹åï¼Œä¼šæ£€æµ‹å¯¹è±¡æ˜¯å¦å®ç°äº† InitializingBeanï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¼šè¿›ä¸€æ­¥è°ƒç”¨ <code class="language-plaintext highlighter-rouge">afterPropertiesSet</code> æ–¹æ³•ï¼Œè°ƒæ•´å¯¹è±¡çŠ¶æ€ã€‚</p>
  </li>
  <li>
    <p>init-method æ˜¯å¯¹è±¡çš„è‡ªå®šä¹‰åˆå§‹åŒ–æ“ä½œï¼Œå¯ä»¥ä»¥ä»»æ„å‘½åã€‚</p>
  </li>
</ul>

<h3 id="äº”disposablebeanå’Œdestroy-method">äº”ã€DisposableBeanå’Œdestroy-method</h3>
<p>DisposableBeanã€destroy-method å’Œ InitializingBeanã€init-method ç›¸å¯¹åº”ï¼Œç»™å¯¹è±¡æä¾›äº†æ‰§è¡Œè‡ªå®šä¹‰é”€æ¯é€»è¾‘çš„åŠŸèƒ½ã€‚</p>

<p>åœ¨å¯¹è±¡è°ƒç”¨å®Œæˆä¹‹åï¼Œå®¹å™¨ä¼šæ£€æŸ¥ <strong>singleton</strong>å¯¹è±¡æ˜¯å¦å®ç°äº† DisposableBean æ¥å£æˆ–å®šä¹‰äº† destroy-methodï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¸ºå¯¹è±¡æ³¨å†Œä¸€ä¸ªç”¨äºå¯¹è±¡é”€æ¯çš„<em>å›è°ƒ</em>ã€‚</p>
:ET