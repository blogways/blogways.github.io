I"É><h3 id="ä¸€æ¦‚è¿°">ä¸€ã€æ¦‚è¿°</h3>
<p>Memcacheæ˜¯dangaçš„ä¸€ä¸ªé¡¹ç›®ï¼Œæœ€æ—©æ˜¯LiveJournal æœåŠ¡çš„ï¼Œæœ€åˆä¸ºäº†åŠ é€Ÿ LiveJournal è®¿é—®é€Ÿåº¦è€Œå¼€å‘çš„ï¼Œåæ¥è¢«å¾ˆå¤šå¤§å‹çš„ç½‘ç«™é‡‡ç”¨ã€‚Memcachedæ˜¯ä»¥å®ˆæŠ¤ç¨‹åºæ–¹å¼è¿è¡Œäºä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨ä¸­ï¼Œéšæ—¶ä¼šæ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥å’Œæ“ä½œã€‚</p>

<p>åœ¨ Memcachedä¸­å¯ä»¥ä¿å­˜çš„itemæ•°æ®é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œåªè¦å†…å­˜è¶³å¤Ÿã€‚Memcachedå•è¿›ç¨‹æœ€å¤§ä½¿ç”¨å†…å­˜ä¸º2Gï¼Œè¦ä½¿ç”¨æ›´å¤šå†…å­˜ï¼Œå¯ä»¥åˆ†å¤šä¸ªç«¯å£å¼€å¯å¤šä¸ªMemcachedè¿›ç¨‹ï¼Œæœ€å¤§30å¤©çš„æ•°æ®è¿‡æœŸæ—¶é—´,è®¾ç½®ä¸ºæ°¸ä¹…çš„ä¹Ÿä¼šåœ¨è¿™ä¸ªæ—¶é—´è¿‡æœŸï¼Œå¸¸é‡REALTIME_MAXDELTA 
60<em>60</em>24*30æ§åˆ¶ï¼Œæœ€å¤§é”®é•¿ä¸º250å­—èŠ‚ï¼Œå¤§äºè¯¥é•¿åº¦æ— æ³•å­˜å‚¨ï¼Œå¸¸é‡KEY_MAX_LENGTH 250æ§åˆ¶ï¼Œå•ä¸ªitemæœ€å¤§æ•°æ®æ˜¯1MBï¼Œè¶…è¿‡1MBæ•°æ®ä¸äºˆå­˜å‚¨ï¼Œå¸¸é‡POWER_BLOCK 1048576è¿›è¡Œæ§åˆ¶ï¼ˆå¯ä»¥ä¿®æ”¹slabs.cï¼šPOWER_BLOCKçš„å€¼ï¼Œç„¶åé‡æ–°ç¼–è¯‘memcachedï¼‰ï¼Œå®ƒæ˜¯é»˜è®¤çš„slabå¤§å°ï¼Œæœ€å¤§åŒæ—¶è¿æ¥æ•°æ˜¯200ï¼Œé€šè¿‡ conn_init()ä¸­çš„freetotalè¿›è¡Œæ§åˆ¶ï¼Œæœ€å¤§è½¯è¿æ¥æ•°æ˜¯1024ï¼Œé€šè¿‡settings.maxconns=1024 è¿›è¡Œæ§åˆ¶ï¼Œè·Ÿç©ºé—´å ç”¨ç›¸å…³çš„å‚æ•°ï¼šsettings.factor=1.25, settings.chunk_size=48,å½±å“slabçš„æ•°æ®å ç”¨å’Œæ­¥è¿›æ–¹å¼ã€‚memcachedæ˜¯ä¸€ç§æ— é˜»å¡çš„socketé€šä¿¡æ–¹å¼æœåŠ¡ï¼ŒåŸºäºlibeventåº“ï¼Œç”±äºæ— é˜»å¡é€šä¿¡ï¼Œå¯¹å†…å­˜è¯»å†™é€Ÿåº¦éå¸¸ä¹‹å¿«ã€‚memcachedåˆ†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ï¼Œå¯ä»¥é…ç½®å¤šä¸ªæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ï¼Œåº”ç”¨äºåˆ†å¸ƒå¼çš„æœåŠ¡éå¸¸å¹¿æ³›ã€‚memcachedä½œä¸ºå°è§„æ¨¡çš„æ•°æ®åˆ†å¸ƒå¼å¹³å°æ˜¯ååˆ†æœ‰æ•ˆæœçš„ã€‚</p>

<p>memcachedæ˜¯é”®å€¼ä¸€ä¸€å¯¹åº”ï¼Œkeyé»˜è®¤æœ€å¤§ä¸èƒ½è¶…è¿‡128ä¸ªå­— èŠ‚ï¼Œvalueé»˜è®¤å¤§å°æ˜¯1Mï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªslabsï¼Œå¦‚æœè¦å­˜2Mçš„å€¼ï¼ˆè¿ç»­çš„ï¼‰ï¼Œä¸èƒ½ç”¨ä¸¤ä¸ªslabsï¼Œå› ä¸ºä¸¤ä¸ªslabsä¸æ˜¯è¿ç»­çš„ï¼Œæ— æ³•åœ¨å†…å­˜ä¸­ å­˜å‚¨ï¼Œæ•…éœ€è¦ä¿®æ”¹slabsçš„å¤§å°ï¼Œå¤šä¸ªkeyå’Œvalueè¿›è¡Œå­˜å‚¨æ—¶ï¼Œå³ä½¿è¿™ä¸ªslabsæ²¡æœ‰åˆ©ç”¨å®Œï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šå­˜æ”¾åˆ«çš„æ•°æ®ã€‚</p>

<p>ç›®å‰memcachedæ”¯æŒC/C++ã€Perlã€PHPã€Pythonã€Rubyã€Javaã€C#ã€Postgresã€Chicken Schemeã€Luaã€MySQLå’ŒProtocolç­‰è¯­è¨€å®¢æˆ·ç«¯ã€‚</p>

<h3 id="äºŒmemcacheå’Œmemcached">äºŒã€Memcacheå’Œmemcached</h3>
<p>å…¶å®Memcacheæ˜¯è¿™ä¸ªé¡¹ç›®çš„åç§°ï¼Œè€Œmemcachedæ˜¯å®ƒæœåŠ¡å™¨ç«¯çš„ä¸»ç¨‹åºæ–‡ä»¶åï¼ŒçŸ¥é“æˆ‘çš„æ„æ€äº†å§ã€‚ä¸€ä¸ªæ˜¯é¡¹ç›®åç§°ï¼Œä¸€ä¸ªæ˜¯ä¸»ç¨‹åºæ–‡ä»¶åï¼Œåœ¨ç½‘ä¸Šçœ‹åˆ°äº†å¾ˆå¤šäººä¸æ˜ç™½ï¼Œäºæ˜¯æ··ç”¨äº†ã€‚</p>

<h3 id="ä¸‰memcached-å®‰è£…">ä¸‰ã€Memcached å®‰è£…</h3>

<p>1.åœ¨Linuxç¯å¢ƒä¸‹åº”ç”¨Memcacheæ—¶ï¼ŒMemcacheç”¨åˆ°äº†libeventè¿™ä¸ªåº“ï¼Œç”¨äºSocketçš„å¤„ç†ï¼Œæ‰€ä»¥è¿˜éœ€è¦å®‰è£…libeventã€‚è¿™é‡Œç”¨çš„libeventçš„ç‰ˆæœ¬æ˜¯libevent-1.4.9ã€‚ä¸‹è½½åœ°å€<a href="http://www.monkey.org/~provos/libevent/">http://www.monkey.org/~provos/libevent/</a>ï¼ˆå¦‚æœä½ çš„ç³»ç»Ÿå·²ç»å®‰è£…äº†libeventï¼Œå¯ä»¥ä¸ç”¨å®‰è£…ï¼‰ã€‚</p>

<p>2.Memcached ä¸‹è½½åœ°å€<a href="https://code.google.com/p/memcached/">https://code.google.com/p/memcached/</a></p>

<p>3.è¿™é‡Œæˆ‘è¿ç”¨äº†Magentä½œä¸ºMemcachedä»£ç†æœåŠ¡å™¨è½¯ä»¶ï¼Œå®ƒå¯ä»¥æ­å»ºé«˜å¯ç”¨æ€§çš„é›†ç¾¤åº”ç”¨çš„MemcachedæœåŠ¡ï¼Œmagenté‡‡ç”¨çš„æ˜¯ï¼šConsistent HashingåŸç†ï¼ŒConsistent Hashingå¦‚ä¸‹æ‰€ç¤ºï¼šé¦–å…ˆæ±‚å‡ºmemcachedæœåŠ¡å™¨ï¼ˆèŠ‚ç‚¹ï¼‰çš„å“ˆå¸Œå€¼ï¼Œ å¹¶å°†å…¶é…ç½®åˆ°0ï½232çš„åœ†ï¼ˆcontinuumï¼‰ä¸Šã€‚ç„¶åç”¨åŒæ ·çš„æ–¹æ³•æ±‚å‡ºå­˜å‚¨æ•°æ®çš„é”®çš„å“ˆå¸Œå€¼ï¼Œå¹¶æ˜ å°„åˆ°åœ†ä¸Šã€‚ç„¶åä»æ•°æ®æ˜ å°„åˆ°çš„ä½ç½®å¼€å§‹é¡ºæ—¶é’ˆæŸ¥æ‰¾ï¼Œå°†æ•°æ®ä¿å­˜åˆ°æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªæœåŠ¡å™¨ä¸Šã€‚ å¦‚æœè¶…è¿‡232ä»ç„¶æ‰¾ä¸åˆ°æœåŠ¡å™¨ï¼Œå°±ä¼šä¿å­˜åˆ°ç¬¬ä¸€å°memcachedæœåŠ¡å™¨ä¸Šï¼Œmagentä¸‹è½½åœ°å€ä¸ºï¼š<a href="http://code.google.com/p/memagent/">http://code.google.com/p/memagent/</a>ã€‚</p>

<p>4.ç¼–è¯‘å®‰è£…libevent</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tar zxvf libevent-1.4.9-stable.tar.gz
cd libevent-1.4.9-stable/
./configure --prefix=/usr
make &amp;&amp; make install
</code></pre></div></div>

<p>5.ç¼–è¯‘å®‰è£…Memcached</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tar zxvf memcached-1[1].4.5.tar.gz
cd memcached-1.4.5/
./configure --with-libevent=/usr
make &amp;&amp; make install
</code></pre></div></div>

<p>6.ç¼–è¯‘å®‰è£…magent</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir magent
cd magent/
tar zxvf magent-0.5.tar.gz
/sbin/ldconfig
sed -i "s#LIBS = -levent#LIBS = -levent -lm#g" Makefile
make
cp magent /usr/bin/magent
</code></pre></div></div>

<p>åœ¨å®‰è£…magentè¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œä¸‹é¢åˆ—ä¸¾å‡ ä¸ªå¯èƒ½å‡ºç°çš„é—®é¢˜åŠè§£å†³æ–¹æ³•ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc -Wall -g -O2 -I/usr/local/include -m64 -c -o magent.o magent.c
magent.c: In function 'writev_list':
magent.c:729: error: 'SSIZE_MAX' undeclared (first use in this function)
magent.c:729: error: (Each undeclared identifier is reported only once
magent.c:729: error: for each function it appears in.)
make: *** [magent.o] Error 1

è§£å†³åŠæ³•ï¼š
[spdev@slave2 magent]# vi ketama.h 
#åœ¨å¼€å¤´åŠ å…¥
#ifndef SSIZE_MAX
#define SSIZE_MAX      32767
#endif

gcc -Wall -g -O2 -I/usr/local/include -m64 -c -o magent.o magent.c
gcc -Wall -g -O2 -I/usr/local/include -m64 -c -o ketama.o ketama.c
gcc -Wall -g -O2 -I/usr/local/include -m64 -o magent magent.o ketama.o
/usr/lib64/libevent.a /usr/lib64/libm.a 
gcc: /usr/lib64/libevent.a: No such file or directory
gcc: /usr/lib64/libm.a: No such file or directory
è§£å†³åŠæ³•ï¼š
[spdev@slave2 magent]#  ln -s /usr/lib/libevent*  /usr/lib64/

gcc -Wall -g -O2 -I/usr/local/include -m64 -o magent magent.o ketama.o 
/usr/lib64/libevent.a /usr/lib64/libm.a 
gcc: /usr/lib64/libm.a: No such file or directory
make: *** [magent] Error 1
è§£å†³åŠæ³•ï¼š
[spdev@slave2 magent]# cp /usr/lib64/libm.so /usr/lib64/libm.a

gcc -Wall -g -O2 -I/usr/local/include -m64 -o magent magent.o ketama.o 
/usr/lib64/libevent.a /usr/lib64/libm.a 
/usr/lib64/libevent.a(event.o): In function `detect_monotonic':
event.c:(.text+0xc79): undefined reference to `clock_gettime'
/usr/lib64/libevent.a(event.o): In function `gettime':
event.c:(.text+0xd60): undefined reference to `clock_gettime'
collect2: ld returned 1 exit status
make: *** [magent] Error 1
è§£å†³åŠæ³•ï¼š
[spdev@slave2 magent]#vi Makefile 
CFLAGS = -Wall -g -O2 -I/usr/local/include $(M64)
æ”¹ä¸ºï¼š    
CFLAGS = -lrt -Wall -g -O2 -I/usr/local/include $(M64)
</code></pre></div></div>

<h3 id="å››å¯åŠ¨å’Œç»“æŸæœåŠ¡">å››ã€å¯åŠ¨å’Œç»“æŸæœåŠ¡</h3>
<p>1.å¯åŠ¨ä¸€ä¸ªMemcacheçš„æœåŠ¡å™¨ç«¯ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>memcached -d -m 10 -u spdev -l 192.168.4.19 -p 11211 -c 256 -P /tmp/memcached.pid
? -d é€‰é¡¹æ˜¯å¯åŠ¨ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œ
? -m æ˜¯åˆ†é…ç»™Memcacheä½¿ç”¨çš„å†…å­˜æ•°é‡ï¼Œå•ä½æ˜¯MBï¼Œæˆ‘è¿™é‡Œæ˜¯10MBï¼Œ
? -u æ˜¯è¿è¡ŒMemcacheçš„ç”¨æˆ·ï¼Œæˆ‘è¿™é‡Œæ˜¯spdevï¼Œ
? -l æ˜¯ç›‘å¬çš„æœåŠ¡å™¨IPåœ°å€ï¼Œæˆ‘è¿™é‡ŒæŒ‡å®šäº†æœåŠ¡å™¨çš„IPåœ°å€192.168.4.19ï¼Œ
? -p æ˜¯è®¾ç½®Memcacheç›‘å¬çš„ç«¯å£ï¼Œæˆ‘è¿™é‡Œè®¾ç½®äº†11211ï¼Œæœ€å¥½æ˜¯1024ä»¥ä¸Šçš„ç«¯å£ï¼Œ
? -c æ˜¯æœ€å¤§è¿è¡Œçš„å¹¶å‘è¿æ¥æ•°ï¼Œé»˜è®¤1024ï¼Œè¿™é‡Œè®¾ç½®äº†256ï¼ŒæŒ‰ç…§æœåŠ¡å™¨çš„è´Ÿè½½é‡æ¥è®¾å®šï¼Œ
? -P æ˜¯è®¾ç½®ä¿å­˜Memcacheçš„pidæ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œæ˜¯ä¿å­˜åœ¨/tmp/memcached.pidã€‚
</code></pre></div></div>

<p>2.ç»“æŸä¸€ä¸ªMemcacheè¿›ç¨‹</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å¦‚æœè¦ç»“æŸMemcacheè¿›ç¨‹ï¼Œæ‰§è¡Œï¼š
# kill `cat /tmp/memcached.pid`
? æ³¨æ„ï¼Œä¸Šé¢å‘½ä»¤ä¸­çš„ç¬¦å·æ˜¯ `ï¼Œä¸æ˜¯å•å¼•å·â€™
</code></pre></div></div>

<p>3.å¯åŠ¨Magentä»£ç†</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>magent -u spdev -n 51200 -l 192.168.4.19 -p 12000 -s 192.168.4.19:11211 
-s 192.168.4.19:11212 -b 192.168.4.19:11213 

-h this message
-u uid
-g gid
-p port, default is 11211. (0 to disable tcp support)
-s ip:port, set memcached server ip and port
-b ip:port, set backup memcached server ip and port
-l ip, local bind ip address, default is 0.0.0.0
-n number, set max connections, default is 4096
-D don't go to background
-k use ketama key allocation algorithm
-f file, unix socket path to listen on. default is off
-i number, max keep alive connections for one memcached server, default is 20
-v verbose

å¯åŠ¨magentä»£ç†æœåŠ¡å™¨ï¼Œç«¯å£ä¸º12000.ä»£ç†æœåŠ¡å™¨ipç«¯å£192.168.4.19:11211ã€
192.168.4.19:11212ï¼Œå¤‡ä»½ä¸»æœºipç«¯å£ä¸º192.168.4.19:11213
</code></pre></div></div>

<h3 id="äº”telnet-memcacheæœåŠ¡å™¨åŠmagentä»£ç†æœåŠ¡å™¨æµ‹è¯•">äº”ã€telnet memcacheæœåŠ¡å™¨åŠmagentä»£ç†æœåŠ¡å™¨æµ‹è¯•</h3>

<ol>
  <li>
    <p>telnet memcache 192.168.4.19:11211æœåŠ¡å™¨</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> C:\Users\Administrator&gt;telnet 192.168.4.19:11211
 set key 0 0 8
 88888888
 STORED
 quit

 é—å¤±å¯¹ä¸»æœºçš„è¿æ¥ã€‚
</code></pre></div>    </div>
  </li>
  <li>
    <p>telnet magent 192.168.4.19:12000ä»£ç†æœåŠ¡å™¨</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> C:\Users\Administrator&gt;telnet 192.168.4.19:12000
 get key
 VALUE key 0 8
 88888888
 END
 quit
</code></pre></div>    </div>

   	é—å¤±å¯¹ä¸»æœºçš„è¿æ¥ã€‚
  </li>
</ol>

<p>è¿™é‡Œå¯ä»¥å‘ç°åœ¨æœåŠ¡å™¨ä¸Šsetçš„å€¼ï¼Œåœ¨ä»£ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å–åˆ°ã€‚</p>

<h3 id="å…­è¿ç”¨libmemcached-cå®¢æˆ·ç«¯ç¼–å†™å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åº">å…­ã€è¿ç”¨libmemcached c++å®¢æˆ·ç«¯ç¼–å†™å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åº</h3>

<p>libmemcachedä¸‹è½½åœ°å€:</p>

<p><a href="https://launchpad.net/libmemcached/+download/">https://launchpad.net/libmemcached/+download/</a></p>

<p>æ­¤å¤„è¦æ³¨æ„ï¼Œlibmemcached 1.0ä»¥ä¸Šç‰ˆæœ¬éœ€è¦gcc4.2ä»¥ä¸Šç‰ˆæœ¬æ‰èƒ½æ”¯æŒï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯æœ€æ–°ç‰ˆlibmemcached-1.0.17ï¼Œè€Œ16ä¸»æœºä¸Šgccç‰ˆæœ¬ä¸º4.12,æ‰€ä»¥æˆ‘å‡çº§äº†gccï¼Œå‡çº§gccæ­¥éª¤è¿™é‡Œå°±ä¸åšä»‹ç»</p>

<ol>
  <li>
    <p>libmemcachedå®¢æˆ·ç«¯ç¨‹åºè¿æ¥magentä»£ç†æœåŠ¡å™¨æµ‹è¯•</p>

    <ul>
      <li>
        <p>å¾ªç¯500000æ¬¡å‘memcacheæœåŠ¡å™¨set 500000æ¡å€¼ï¼Œæœ¬æ¬¡æµ‹è¯•æ˜¯ipä¸º
 192.168.4.16çš„ä¸»æœºè°ƒipä¸º192.168.4.19çš„memcacheæœåŠ¡å™¨ï¼Œå…·ä½“
 è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Save data:begin
  2013-04-29 15:39:32.129
  2013-04-29 15:41:43.406
  Save data:end ä»ä¸Šé¢æ•°æ®çœ‹å‡ºset 500000æ•°æ®ç”¨äº†2åˆ†å¤šé’Ÿ
</code></pre></div>        </div>
      </li>
      <li>
        <p>å¾ªç¯10000æ¬¡ï¼Œæ¯æ¬¡éšæœºå–1-500000ä¸­ä»»æ„ä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åä»ä¸Šé¢setçš„å€¼ä¸­getå¯¹åº”
æ•°æ®ï¼Œå…·ä½“è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  2013-04-29 15:41:43.406
  2013-04-29 15:41:45.899 ç”±æ­¤çœ‹å‡ºéšæœºå–10000æ¡æ•°æ®ç”¨äº†ä¸¤ç§’å¤šçš„æ—¶é—´
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ol>

<p>2.libmemcachedå®¢æˆ·ç«¯ç¨‹åºç›´æ¥è¿æ¥memcacheæœåŠ¡å™¨æµ‹è¯•</p>

<ul>
  <li>
    <p>å¾ªç¯500000æ¬¡å‘memcacheæœåŠ¡å™¨set 500000æ¡å€¼ï¼Œæœ¬æ¬¡æµ‹è¯•æ˜¯ipä¸º
192.168.4.16çš„ä¸»æœºè°ƒipä¸º192.168.4.19çš„memcacheæœåŠ¡å™¨ï¼Œå…·ä½“
è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Save data:begin
  2013-04-29 20:28:42.439
  2013-04-29 20:30:10.462
  Save data:end ä»ä¸Šé¢æ•°æ®çœ‹å‡ºset 500000æ•°æ®ç”¨äº†1åˆ†å¤šé’Ÿ
</code></pre></div>    </div>
  </li>
  <li>
    <p>å¾ªç¯10000æ¬¡ï¼Œæ¯æ¬¡éšæœºå–1-500000ä¸­ä»»æ„ä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åä»ä¸Šé¢setçš„å€¼ä¸­getå¯¹åº”
æ•°æ®ï¼Œå…·ä½“è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  2013-04-29 20:30:10.462
  2013-04-29 20:30:12.085 ç”±æ­¤çœ‹å‡ºéšæœºå–10000æ¡æ•°æ®ç”¨äº†1ç§’å¤šçš„æ—¶é—´
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="ä¸ƒè¿ç”¨memcached-client-for-javaå®¢æˆ·ç«¯ç¼–å†™å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åº">ä¸ƒã€è¿ç”¨memcached client for javaå®¢æˆ·ç«¯ç¼–å†™å®¢æˆ·ç«¯æµ‹è¯•ç¨‹åº</h3>

<p>memcached client for javaä¸‹è½½åœ°å€ä¸ºï¼š</p>

<p><a href="http://github.com/gwhalin/Memcached-Java-Client/">http://github.com/gwhalin/Memcached-Java-Client/</a></p>

<ol>
  <li>
    <p>javaå®¢æˆ·ç«¯ç¨‹åºè¿æ¥magentä»£ç†æœåŠ¡å™¨æµ‹è¯•</p>

    <ul>
      <li>
        <p>å¾ªç¯500000æ¬¡å‘memcacheæœåŠ¡å™¨set 500000æ¡å€¼ï¼Œæœ¬æ¬¡æµ‹è¯•æ˜¯ipä¸º
 192.168.4.16çš„ä¸»æœºè°ƒipä¸º192.168.4.19çš„memcacheæœåŠ¡å™¨ï¼Œå…·ä½“
 è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  save begin:2013-04-29 10:09:04:0790
  save end:2013-04-29 10:13:11:0721 ä»ä¸Šé¢æ•°æ®çœ‹å‡ºset 500000æ•°æ®ç”¨äº†4åˆ†å¤šé’Ÿ
</code></pre></div>        </div>
      </li>
      <li>
        <p>å¾ªç¯10000æ¬¡ï¼Œæ¯æ¬¡éšæœºå–1-500000ä¸­ä»»æ„ä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åä»ä¸Šé¢setçš„å€¼ä¸­getå¯¹åº”
æ•°æ®ï¼Œå…·ä½“è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  get begin:2013-04-29 10:13:11:0722
  get end:2013-04-29 10:13:16:0678 ç”±æ­¤çœ‹å‡ºéšæœºå–10000æ¡æ•°æ®ç”¨äº†4ç§’å¤šçš„æ—¶é—´
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ol>

<p>2.javaå®¢æˆ·ç«¯ç¨‹åºç›´æ¥è¿æ¥memcacheæœåŠ¡å™¨æµ‹è¯•</p>

<ul>
  <li>
    <p>å¾ªç¯500000æ¬¡å‘memcacheæœåŠ¡å™¨set 500000æ¡å€¼ï¼Œæœ¬æ¬¡æµ‹è¯•æ˜¯ipä¸º
192.168.4.16çš„ä¸»æœºè°ƒipä¸º192.168.4.19çš„memcacheæœåŠ¡å™¨ï¼Œå…·ä½“
è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  save begin:2013-04-29 20:21:46:0195
  save end:2013-04-29 20:25:06:0365 ä»ä¸Šé¢æ•°æ®çœ‹å‡ºset 500000æ•°æ®ç”¨äº†3åˆ†å¤šé’Ÿ
</code></pre></div>    </div>
  </li>
  <li>
    <p>å¾ªç¯10000æ¬¡ï¼Œæ¯æ¬¡éšæœºå–1-500000ä¸­ä»»æ„ä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åä»ä¸Šé¢setçš„å€¼ä¸­getå¯¹åº”
æ•°æ®ï¼Œå…·ä½“è°ƒç”¨æ—¶é—´å¦‚ä¸‹ï¼š</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  get begin:2013-04-29 20:25:06:0366
  get end:2013-04-29 20:25:10:0357 ç”±æ­¤çœ‹å‡ºéšæœºå–10000æ¡æ•°æ®ç”¨äº†æ¥è¿‘4ç§’çš„æ—¶é—´
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="å…«è¯´æ˜">å…«ã€è¯´æ˜</h3>

<ol>
  <li>
    <p>ä»æ­¥éª¤ä¸ƒä¸­æµ‹è¯•ç»“æœå¯ä»¥çœ‹å‡ºï¼Œc++å®¢æˆ·ç«¯è°ƒç”¨memcacheæœåŠ¡å™¨åœ¨æ€§èƒ½ä¸Šæ˜æ˜¾ä¼˜äºjavaå®¢æˆ·ç«¯ï¼ŒåŒæ—¶è¿ç”¨magentä»£ç†æœåŠ¡å™¨æ—¶æ€§èƒ½ä¸Šè¿˜æ˜¯æœ‰æ‰€é™ä½</p>
  </li>
  <li>
    <p>è‡³äºredisä¸memcacheæ€§èƒ½å·®å¼‚æœ¬æ–‡æ²¡æœ‰åšå¯¹æ¯”ï¼Œå¯å‚ç…§redisæ–‡æ¡£ä¸­åˆ—å‡ºçš„æµ‹è¯•æ•°æ®åŠ ä»¥å¯¹æ¯”ï¼Œè¿™é‡Œåˆ—ä¸‹åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€äº›å¤§æ‹¿ä»¬åˆ—å‡ºçš„å¯¹æ¯”ï¼š</p>

    <ul>
      <li>
        <p>æ€§èƒ½å¯¹æ¯”ï¼šç”±äºRedisåªä½¿ç”¨å•æ ¸ï¼Œè€ŒMemcachedå¯ä»¥ä½¿ç”¨å¤šæ ¸ï¼Œæ‰€ä»¥å¹³å‡æ¯ä¸€ä¸ªæ ¸ä¸ŠRedisåœ¨å­˜å‚¨å°æ•°æ®æ—¶æ¯”Memcachedæ€§èƒ½æ›´é«˜ã€‚è€Œåœ¨100kä»¥ä¸Šçš„æ•°æ®ä¸­ï¼ŒMemcachedæ€§èƒ½è¦é«˜äºRedisï¼Œè™½ç„¶Redisæœ€è¿‘ä¹Ÿåœ¨å­˜å‚¨å¤§æ•°æ®çš„æ€§èƒ½ä¸Šè¿›è¡Œä¼˜åŒ–ï¼Œä½†æ˜¯æ¯”èµ·Memcachedï¼Œè¿˜æ˜¯ç¨æœ‰é€Šè‰²</p>
      </li>
      <li>
        <p>å†…å­˜ä½¿ç”¨æ•ˆç‡å¯¹æ¯”ï¼šä½¿ç”¨ç®€å•çš„key-valueå­˜å‚¨çš„è¯ï¼ŒMemcachedçš„å†…å­˜åˆ©ç”¨ç‡æ›´é«˜ï¼Œè€Œå¦‚æœRedisé‡‡ç”¨hashç»“æ„æ¥åškey-valueå­˜å‚¨ï¼Œç”±äºå…¶ç»„åˆå¼çš„å‹ç¼©ï¼Œå…¶å†…å­˜åˆ©ç”¨ç‡ä¼šé«˜äºMemcached</p>
      </li>
      <li>
        <p>Redisæ”¯æŒæœåŠ¡å™¨ç«¯çš„æ•°æ®æ“ä½œï¼šRedisç›¸æ¯”Memcachedæ¥è¯´ï¼Œæ‹¥æœ‰æ›´å¤šçš„æ•°æ®ç»“æ„å’Œå¹¶æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®æ“ä½œï¼Œé€šå¸¸åœ¨Memcachedé‡Œï¼Œä½ éœ€è¦å°†æ•°æ®æ‹¿åˆ°å®¢æˆ·ç«¯æ¥è¿›è¡Œç±»ä¼¼çš„ä¿®æ”¹å†setå›å»ã€‚è¿™å¤§å¤§å¢åŠ äº†ç½‘ç»œIOçš„æ¬¡æ•°å’Œæ•°æ®ä½“ç§¯ã€‚åœ¨Redisä¸­ï¼Œè¿™äº›å¤æ‚çš„æ“ä½œé€šå¸¸å’Œä¸€èˆ¬çš„GET/SETä¸€æ ·é«˜æ•ˆã€‚æ‰€ä»¥ï¼Œå¦‚æœéœ€è¦ç¼“å­˜èƒ½å¤Ÿæ”¯æŒæ›´å¤æ‚çš„ç»“æ„å’Œæ“ä½œï¼Œé‚£ä¹ˆRedisä¼šæ˜¯ä¸é”™çš„é€‰æ‹©</p>
      </li>
    </ul>
  </li>
</ol>

:ET